---
output: html_document
runtime: shiny
---
# Salivary gland tumor genetics project

~~I am writing a paper descring these result at google docs.~~

Switching to word with endnote, because of the paperfile. 


=======
### Data load
```{r echo=FALSE}
d <- read.csv("Saliva_TERT_pik3ca.csv")
```


```{r echo=FALSE}
# loading librarys
require("ggplot2")
require("moonBook")
require("ztable")
```

### Data summary and manupulation
```{r echo=FALSE}
summary(d)

# naming the histology group
d$hist_group<-factor(d$hist_group, levels=c(1,2,3,4), labels = c("pleomorphic adenoma", "warthin", "carcinoma", "etc")) 
d$sex <- factor(d$sex, levels=c(1,2), labels = c("male", "female")) 
```

### benign tumor histology, gender density bar graph
```{r, echo=FALSE}
d_b <- subset(d, hist_group != "carcinoma")

d_b_sub <-d_b[c("sex", "age", "location", "histology", "size")]

reorder_size <- function(x) {
  factor(x, levels = names(sort(table(x), decreasing = T)))
}

ggplot(d_b_sub, aes(reorder_size(histology))) + geom_bar(aes(fill=sex)) +
  scale_x_discrete("histology", 
                   labels = c("pleomorphic adenoma" ="PA", 
                              "warthin tumor" = "Warthin", 
                              "basal cell adenoma" = "BCA",
                              "epidermal inclusion cyst" = "EIC",
                              "chronic sclerosing sialadenitis" = "CSS",
                              "unremarkable" = "N/D")) + 
  scale_fill_brewer(palette = "Set1") +
  labs(x ="histolgy", y = "")


ggplot(d_b_sub, aes(sex)) + geom_bar(aes(fill=reorder_size(histology))) +
  scale_fill_brewer(palette = "Set1")

ggplot(d_b_sub, aes(sex)) + geom_bar(aes(fill=location)) +
  scale_fill_brewer(palette = "Set1")

ggplot(d_b_sub, aes(sex, age)) + geom_boxplot(aes(fill=sex)) + 
  scale_fill_brewer(palette = "Set1")

ggplot(d_b_sub, aes(x = sex,y =size)) + 
  geom_dotplot(binaxis = "y",binwidth = 0.2, stackdir = "center", aes(fill = sex)) +
  scale_fill_brewer(palette = "Set1")



### Gender table
```{r echo=FALSE}
d_t<-d[c("sex", "age", "location", "hist_group","size" )]

ztable( mytable(sex~.,data=d_t))
```

### Histology table
```{r echo=FALSE}
ztable(mytable(hist_group~., data=d_t))
```


### Box plot
```{r echo=FALSE}
# plotting the box plot for telomere length
ggplot(d, aes(hist_group, telomere_length)) + geom_boxplot(fill = "grey") +
  scale_x_discrete(labels = c ("PA","WT","CA","etc")) + 
  labs(x ="Histology group", y="Telomere length") + 
  theme(legend.position="none") +
  theme_bw() + scale_y_log10()

ggsave("telomere.tiff", units = "in", width = 5, height = 4, dpi =300)

#PIK3CA
ggplot(d, aes(hist_group, PIK3CA_amp)) + geom_boxplot(fill = "grey") +
  scale_x_discrete(labels = c ("PA","WT","CA","etc")) + 
  labs(x ="Histology group", y="PIK3CA amplication") + 
  theme(legend.position="none") +
  theme_bw()

ggsave("pik3ca.tiff", units = "in", width = 5, height = 4, dpi = 300)

#mitochondria CNV
ggplot(d, aes(hist_group, MT_copynumber)) + geom_boxplot(fill = "grey") +
  scale_x_discrete(labels = c ("PA","WT","CA","etc")) + 
  labs(x ="Histology group", y="mitochondria copy number") + 
  theme(legend.position="none") +
  theme_bw() + scale_y_log10()

ggsave("mito.tiff", units = "in", width = 5, height =4, dpi = 300)


d_mt <-subset(d, MT_copynumber <10000)

ggplot(d_mt, aes(hist_group, MT_copynumber)) + geom_boxplot(fill = "grey") +
  scale_x_discrete(labels = c ("PA","WT","CA","etc")) + 
  labs(x ="Histology group", y="mitochondria copy number") + 
  theme(legend.position="none") +
  theme_bw() + scale_y_log10()

ggsave("mito_sub.tiff", units = "in", width = 5, height =4, dpi = 300)
```

### ANOVA
Size vs histology
```{r echo=FALSE}
d_size_aov <- aov(size~hist_group, data=d)
summary(d_size_aov)
```

Telomere length vs histology
```{r echo=FALSE}
d_tl_aov <- aov(telomere_length~hist_group, data=d)
summary(d_tl_aov)
```

PIK3CA expression vs histology
```{r echo=FALSE}
d_PIK_aov <- aov(PIK3CA_amp~hist_group, data=d)
summary(d_PIK_aov)
```

mitochondria vs histology
```{r echo=FALSE}
d_mt_aov <- aov(MT_copynumber~hist_group, data=d_mt)
summary(d_mt_aov)
```

### ploting size vs telomere length , histology group
```{r echo=FALSE}
qplot(size, telomere_length, data=d, shape=hist_group, color = hist_group, ylim = c(0,120))
```

### ploting size vs PIK3CA expression , histology group
```{r echo=FALSE}
qplot(size, PIK3CA_amp, data=d, shape=hist_group, color = hist_group)
```

### ploting size vs Mitochondria copy number, histology group
```{r echo=FALSE}
qplot(size, MT_copynumber, data=d, shape = hist_group, color = hist_group, ylim = c(0,10))
```

### ploting telomere length vs PIK3CA, histology group
```{r echo=FALSE}
qplot(telomere_length, PIK3CA_amp, data=d,  shape=hist_group, color = hist_group, xlim = c(0,120))
```

### ploting telomere length vs mitochondria, histology group
```{r echo=FALSE}
qplot(telomere_length, MT_copynumber, data=d,  shape=hist_group, color = hist_group, xlim = c(0,120), ylim = c(0,9))
```
