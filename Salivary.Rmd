---
output: html_document
runtime: shiny
---
# Salivary gland tumor genetics project

I am writing a paper descring these result at google docs.


### Data load
```{r echo=FALSE}
d <- read.csv("Saliva_TERT_pik3ca.csv")
```


```{r echo=FALSE}
# loading librarys
require("ggplot2")
require("moonBook")
require("ztable")
```

### Data summary and manupulation
```{r echo=FALSE}
summary(d)

# naming the histology group
d$hist_group<-factor(d$hist_group, levels=c(1,2,3,4), labels = c("pleomorphic adenoma", "warthin", "carcinoma", "etc")) 
d$sex <- factor(d$sex, levels=c(1,2), labels = c("male", "female")) 
```


### Gender table
```{r echo=FALSE}

sexvar<-c("sex", "age", "location", "hist_group","size" )
d_t<-d[sexvar]
sex_table <- mytable(sex~.,data=d_t)
ztable(sex_table)
```

### Histology table
```{r echo=FALSE}
hist_table <- mytable(hist_group~., data=d_t)
ztable(hist_table)
```

### Histology based seletion
```{r echo=FALSE}
Saliva_3 <- subset(Saliva, hist_group<4)
>>>>>>> origin/master
Saliva_3_table <- Saliva_3[sexvar]
#res_sex_3= mytable(sex~.,data=Saliva_3_table)
#ztable(res_sex_3)
#res_hist_3= mytable(hist_group~., data=Saliva_3_table)
#ztable(res_hist_3)
mytable(sex~.,data=Saliva_3_table)
<<<<<<< HEAD
```

### Histology-based table
```{r echo=FALSE}
=======
>>>>>>> origin/master
mytable(hist_group~., data=Saliva_3_table)
```

### Box plot
```{r echo=FALSE}
<<<<<<< HEAD
Saliva_3_TL <- subset(Saliva_3, telomere_length<40) # excluding outlier data in the telomere length
qplot(hist_group, size, data = Saliva_3, geom = c("boxplot", "jitter"), fill = hist_group) # plotting the box plot for size
qplot(hist_group, telomere_length, data=Saliva_3_TL, geom=c("boxplot", "jitter"), fill=hist_group) # plotting the box plot for telomere length
qplot(hist_group, PIK3CA_amp, data=Saliva_3, geom=c("boxplot", "jitter"), fill=hist_group) # plotting the box plot for PIK3CA expression 
Saliva_3_MT <- subset(Saliva_3, MT_copynumber<100) # excluding outlier data in the mitochondria copy number
qplot(hist_group, MT_copynumber, data=Saliva_3_MT, geom=c("boxplot", "jitter"), fill=hist_group) # plotting the box plot for mitochondria copy number
```

### ANOVA
Size vs histology
```{r echo=FALSE}
Saliva.size.aov <- aov(size~hist_group, data=Saliva_3)
summary(Saliva.size.aov)
```

Telomere length vs histology
```{r echo=FALSE}
Saliva.tl.aov <- aov(telomere_length~hist_group, data=Saliva_3_TL)
summary(Saliva.tl.aov)
```

PIK3CA expression vs histology
```{r echo=FALSE}
Saliva.PIK.aov <- aov(PIK3CA_amp~hist_group, data=Saliva_3)
summary(Saliva.PIK.aov)
```

mitochondria vs histology
```{r echo=FALSE}
Saliva.MT.aov <- aov(MT_copynumber~hist_group, data=Saliva_3_MT)
summary(Saliva.MT.aov)
```

### ploting size vs telomere length , histology group
```{r echo=FALSE}
qplot(size, telomere_length, data=Saliva_3, shape=hist_group, color = hist_group, ylim = c(0,40))
```

### ploting size vs PIK3CA expression , histology group
```{r echo=FALSE}
qplot(size, PIK3CA_amp, data=Saliva_3, shape=hist_group, color = hist_group)
```

### ploting size vs Mitochondria copy number, histology group
```{r echo=FALSE}
qplot(size, MT_copynumber, data=Saliva_3, shape = hist_group, color = hist_group, ylim = c(0,9))
```

### ploting telomere length vs PIK3CA, histology group
```{r echo=FALSE}
qplot(telomere_length, PIK3CA_amp, data=Saliva_3,  shape=hist_group, color = hist_group, xlim = c(0,40))
```

### ploting telomere length vs mitochondria, histology group
```{r echo=FALSE}
qplot(telomere_length, MT_copynumber, data=Saliva_3,  shape=hist_group, color = hist_group, xlim = c(0,40), ylim = c(0,9))
```

### ploting telomere length vs mitochondria, histology group
```{r echo=FALSE}
qplot(PIK3CA_amp, MT_copynumber, data=Saliva_3, shape = hist_group, color = hist_group, ylim = c(0,9))
=======
Saliva_3$hist_group<-factor(Saliva_3$hist_group, levels=c(1,2,3), labels = c("pleomorphic adenoma", "warthin", "carcinoma"))
Saliva_3_TL <- subset(Saliva_3, telomere_length<40)
qplot(hist_group, telomere_length, data=Saliva_3_TL, geom=c("boxplot", "jitter"), fill=hist_group)
qplot(hist_group, PIK3CA_amp, data=Saliva_3, geom=c("boxplot", "jitter"), fill=hist_group)
Saliva_3_MT <- subset(Saliva_3, MT_copynumber<100)
qplot(hist_group, MT_copynumber, data=Saliva_3_MT, geom=c("boxplot", "jitter"), fill=hist_group)
>>>>>>> origin/master
```
